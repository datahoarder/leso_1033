/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 2014.01
 * @requires jQuery v1.8 or greater - jQuery 1.10.x recommended
 *
 * Copyright (c) 2009-2014 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/*
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
/* jshint undef: true */
/* global L_Menu_BaseUrl, _spUserId, _spPageContextInfo, GipAddSelectedItems, GipRemoveSelectedItems, GipGetGroupData */
(function(am){var ab="2014.01";var Q="/";var aj="Column not found on page";var ad="http://schemas.microsoft.com/sharepoint";var aq="MultiLookupPicker";var g="MultiLookup";var Y={simple:"S",complex:"C",multiSelect:"M"};var ap=["Text","DateTime","datetime","User","UserMulti","Lookup","LookupMulti","Boolean","Integer","Counter","MultiChoice","Currency","float","Calc","Attachments","Calculated","ContentTypeId","Note","URL","Number","Choice","ModStat","Guid","File"];var B={};var b="Alerts";var v="Authentication";var ao="Copy";var G="Forms";var aw="Lists";var m="Meetings";var C="People";var f="Permissions";var h="PublishedLinksService";var ak="Search";var ai="SharePointDiagnostics";var aa="SiteData";var aD="Sites";var J="SocialDataService";var ag="SpellCheck";var o="TaxonomyClientService";var l="usergroup";var K="UserProfileService";var E="Versions";var aC="Views";var e="WebPartPages";var az="Webs";var F="Workflow";var ae=new at();var O=0;var y=["listName","description"];var U=[];U.GetAlerts=[b,false];U.DeleteAlerts=[b,true];U.Mode=[v,false];U.Login=[v,false];U.CopyIntoItems=[ao,true];U.CopyIntoItemsLocal=[ao,true];U.GetItem=[ao,false];U.GetForm=[G,false];U.GetFormCollection=[G,false];U.AddAttachment=[aw,true];U.AddDiscussionBoardItem=[aw,true];U.AddList=[aw,true];U.AddListFromFeature=[aw,true];U.ApplyContentTypeToList=[aw,true];U.CheckInFile=[aw,true];U.CheckOutFile=[aw,true];U.CreateContentType=[aw,true];U.DeleteAttachment=[aw,true];U.DeleteContentType=[aw,true];U.DeleteContentTypeXmlDocument=[aw,true];U.DeleteList=[aw,true];U.GetAttachmentCollection=[aw,false];U.GetList=[aw,false];U.GetListAndView=[aw,false];U.GetListCollection=[aw,false];U.GetListContentType=[aw,false];U.GetListContentTypes=[aw,false];U.GetListItemChanges=[aw,false];U.GetListItemChangesSinceToken=[aw,false];U.GetListItems=[aw,false];U.GetVersionCollection=[aw,false];U.UndoCheckOut=[aw,true];U.UpdateContentType=[aw,true];U.UpdateContentTypesXmlDocument=[aw,true];U.UpdateContentTypeXmlDocument=[aw,true];U.UpdateList=[aw,true];U.UpdateListItems=[aw,true];U.AddMeeting=[m,true];U.CreateWorkspace=[m,true];U.RemoveMeeting=[m,true];U.SetWorkSpaceTitle=[m,true];U.ResolvePrincipals=[C,false];U.SearchPrincipals=[C,false];U.AddPermission=[f,true];U.AddPermissionCollection=[f,true];U.GetPermissionCollection=[f,true];U.RemovePermission=[f,true];U.RemovePermissionCollection=[f,true];U.UpdatePermission=[f,true];U.GetLinks=[h,true];U.GetPortalSearchInfo=[ak,false];U.GetQuerySuggestions=[ak,false];U.GetSearchMetadata=[ak,false];U.Query=[ak,false];U.QueryEx=[ak,false];U.Registration=[ak,false];U.Status=[ak,false];U.SendClientScriptErrorReport=[ai,true];U.GetAttachments=[aa,false];U.EnumerateFolder=[aa,false];U.SiteDataGetList=[aa,false];U.SiteDataGetListCollection=[aa,false];U.SiteDataGetSite=[aa,false];U.SiteDataGetSiteUrl=[aa,false];U.SiteDataGetWeb=[aa,false];U.CreateWeb=[aD,true];U.DeleteWeb=[aD,true];U.GetSite=[aD,false];U.GetSiteTemplates=[aD,false];U.AddComment=[J,true];U.AddTag=[J,true];U.AddTagByKeyword=[J,true];U.CountCommentsOfUser=[J,false];U.CountCommentsOfUserOnUrl=[J,false];U.CountCommentsOnUrl=[J,false];U.CountRatingsOnUrl=[J,false];U.CountTagsOfUser=[J,false];U.DeleteComment=[J,true];U.DeleteRating=[J,true];U.DeleteTag=[J,true];U.DeleteTagByKeyword=[J,true];U.DeleteTags=[J,true];U.GetAllTagTerms=[J,false];U.GetAllTagTermsForUrlFolder=[J,false];U.GetAllTagUrls=[J,false];U.GetAllTagUrlsByKeyword=[J,false];U.GetCommentsOfUser=[J,false];U.GetCommentsOfUserOnUrl=[J,false];U.GetCommentsOnUrl=[J,false];U.GetRatingAverageOnUrl=[J,false];U.GetRatingOfUserOnUrl=[J,false];U.GetRatingOnUrl=[J,false];U.GetRatingsOfUser=[J,false];U.GetRatingsOnUrl=[J,false];U.GetSocialDataForFullReplication=[J,false];U.GetTags=[J,true];U.GetTagsOfUser=[J,true];U.GetTagTerms=[J,true];U.GetTagTermsOfUser=[J,true];U.GetTagTermsOnUrl=[J,true];U.GetTagUrlsOfUser=[J,true];U.GetTagUrlsOfUserByKeyword=[J,true];U.GetTagUrls=[J,true];U.GetTagUrlsByKeyword=[J,true];U.SetRating=[J,true];U.UpdateComment=[J,true];U.SpellCheck=[ag,false];U.AddTerms=[o,true];U.GetChildTermsInTerm=[o,false];U.GetChildTermsInTermSet=[o,false];U.GetKeywordTermsByGuids=[o,false];U.GetTermsByLabel=[o,false];U.GetTermSets=[o,false];U.AddGroup=[l,true];U.AddGroupToRole=[l,true];U.AddRole=[l,true];U.AddRoleDef=[l,true];U.AddUserCollectionToGroup=[l,true];U.AddUserCollectionToRole=[l,true];U.AddUserToGroup=[l,true];U.AddUserToRole=[l,true];U.GetAllUserCollectionFromWeb=[l,false];U.GetGroupCollection=[l,false];U.GetGroupCollectionFromRole=[l,false];U.GetGroupCollectionFromSite=[l,false];U.GetGroupCollectionFromUser=[l,false];U.GetGroupCollectionFromWeb=[l,false];U.GetGroupInfo=[l,false];U.GetRoleCollection=[l,false];U.GetRoleCollectionFromGroup=[l,false];U.GetRoleCollectionFromUser=[l,false];U.GetRoleCollectionFromWeb=[l,false];U.GetRoleInfo=[l,false];U.GetRolesAndPermissionsForCurrentUser=[l,false];U.GetRolesAndPermissionsForSite=[l,false];U.GetUserCollection=[l,false];U.GetUserCollectionFromGroup=[l,false];U.GetUserCollectionFromRole=[l,false];U.GetUserCollectionFromSite=[l,false];U.GetUserCollectionFromWeb=[l,false];U.GetUserInfo=[l,false];U.GetUserLoginFromEmail=[l,false];U.RemoveGroup=[l,true];U.RemoveGroupFromRole=[l,true];U.RemoveRole=[l,true];U.RemoveUserCollectionFromGroup=[l,true];U.RemoveUserCollectionFromRole=[l,true];U.RemoveUserCollectionFromSite=[l,true];U.RemoveUserFromGroup=[l,true];U.RemoveUserFromRole=[l,true];U.RemoveUserFromSite=[l,true];U.RemoveUserFromWeb=[l,true];U.UpdateGroupInfo=[l,true];U.UpdateRoleDefInfo=[l,true];U.UpdateRoleInfo=[l,true];U.UpdateUserInfo=[l,true];U.AddColleague=[K,true];U.AddLink=[K,true];U.AddMembership=[K,true];U.AddPinnedLink=[K,true];U.CreateMemberGroup=[K,true];U.CreateUserProfileByAccountName=[K,true];U.GetCommonColleagues=[K,false];U.GetCommonManager=[K,false];U.GetCommonMemberships=[K,false];U.GetInCommon=[K,false];U.GetPropertyChoiceList=[K,false];U.GetUserColleagues=[K,false];U.GetUserLinks=[K,false];U.GetUserMemberships=[K,false];U.GetUserPinnedLinks=[K,false];U.GetUserProfileByGuid=[K,false];U.GetUserProfileByIndex=[K,false];U.GetUserProfileByName=[K,false];U.GetUserProfileCount=[K,false];U.GetUserProfileSchema=[K,false];U.GetUserPropertyByAccountName=[K,false];U.ModifyUserPropertyByAccountName=[K,true];U.RemoveAllColleagues=[K,true];U.RemoveAllLinks=[K,true];U.RemoveAllMemberships=[K,true];U.RemoveAllPinnedLinks=[K,true];U.RemoveColleague=[K,true];U.RemoveLink=[K,true];U.RemoveMembership=[K,true];U.RemovePinnedLink=[K,true];U.UpdateColleaguePrivacy=[K,true];U.UpdateLink=[K,true];U.UpdateMembershipPrivacy=[K,true];U.UpdatePinnedLink=[K,true];U.DeleteAllVersions=[E,true];U.DeleteVersion=[E,true];U.GetVersions=[E,false];U.RestoreVersion=[E,true];U.AddView=[aC,true];U.DeleteView=[aC,true];U.GetView=[aC,false];U.GetViewHtml=[aC,false];U.GetViewCollection=[aC,false];U.UpdateView=[aC,true];U.UpdateViewHtml=[aC,true];U.AddWebPart=[e,true];U.AddWebPartToZone=[e,true];U.GetWebPart2=[e,false];U.GetWebPartPage=[e,false];U.GetWebPartProperties=[e,false];U.GetWebPartProperties2=[e,false];U.CreateContentType=[az,true];U.GetColumns=[az,false];U.GetContentType=[az,false];U.GetContentTypes=[az,false];U.GetCustomizedPageStatus=[az,false];U.GetListTemplates=[az,false];U.GetObjectIdFromUrl=[az,false];U.GetWeb=[az,false];U.GetWebCollection=[az,false];U.GetAllSubWebCollection=[az,false];U.UpdateColumns=[az,true];U.UpdateContentType=[az,true];U.WebUrlFromPageUrl=[az,false];U.AlterToDo=[F,true];U.ClaimReleaseTask=[F,true];U.GetTemplatesForItem=[F,false];U.GetToDosForItem=[F,false];U.GetWorkflowDataForItem=[F,false];U.GetWorkflowTaskData=[F,false];U.StartWorkflow=[F,true];var T={};T.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";T.footer="</soap:Body></soap:Envelope>";T.payload="";var ac;am.fn.SPServices=function(aF){var aH=am.extend({},am.fn.SPServices.defaults,aF);for(var aG=0;aG<y.length;aG++){if(typeof aH[y[aG]]==="string"){aH[y[aG]]=j(aH[y[aG]])}}T.opheader="<"+aH.operation+" ";switch(U[aH.operation][0]){case b:T.opheader+="xmlns='"+ad+"/soap/2002/1/alerts/' >";ac=ad+"/soap/2002/1/alerts/";break;case m:T.opheader+="xmlns='"+ad+"/soap/meetings/' >";ac=ad+"/soap/meetings/";break;case f:T.opheader+="xmlns='"+ad+"/soap/directory/' >";ac=ad+"/soap/directory/";break;case h:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";ac="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case ak:T.opheader+="xmlns='urn:Microsoft.Search' >";ac="urn:Microsoft.Search/";break;case ai:T.opheader+="xmlns='"+ad+"/diagnostics/' >";ac="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case J:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";ac="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case ag:T.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >";ac="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case o:T.opheader+="xmlns='"+ad+"/taxonomy/soap/' >";ac=ad+"/taxonomy/soap/";break;case l:T.opheader+="xmlns='"+ad+"/soap/directory/' >";ac=ad+"/soap/directory/";break;case K:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";ac="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case e:T.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";ac="http://microsoft.com/sharepoint/webpartpages/";break;case F:T.opheader+="xmlns='"+ad+"/soap/workflow/' >";ac=ad+"/soap/workflow/";break;default:T.opheader+="xmlns='"+ad+"/soap/'>";ac=ad+"/soap/";break}ac+=aH.operation;T.opfooter="</"+aH.operation+">";var aJ="_vti_bin/"+U[aH.operation][0]+".asmx";var aE=am().SPServices.SPGetCurrentSite();if(aH.webURL.charAt(aH.webURL.length-1)===Q){aJ=aH.webURL+aJ}else{if(aH.webURL.length>0){aJ=aH.webURL+Q+aJ}else{aJ=aE+((aE.charAt(aE.length-1)===Q)?aJ:(Q+aJ))}}T.payload="";switch(aH.operation){case"GetAlerts":break;case"DeleteAlerts":T.payload+="<IDs>";for(aG=0;aG<aH.IDs.length;aG++){T.payload+=ay("string",aH.IDs[aG])}T.payload+="</IDs>";break;case"Mode":break;case"Login":av(aH,["username","password"]);break;case"CopyIntoItems":av(aH,["SourceUrl"]);T.payload+="<DestinationUrls>";for(aG=0;aG<aH.DestinationUrls.length;aG++){T.payload+=ay("string",aH.DestinationUrls[aG])}T.payload+="</DestinationUrls>";av(aH,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":av(aH,["SourceUrl"]);T.payload+="<DestinationUrls>";for(aG=0;aG<aH.DestinationUrls.length;aG++){T.payload+=ay("string",aH.DestinationUrls[aG])}T.payload+="</DestinationUrls>";break;case"GetItem":av(aH,["Url","Fields","Stream"]);break;case"GetForm":av(aH,["listName","formUrl"]);break;case"GetFormCollection":av(aH,["listName"]);break;case"AddAttachment":av(aH,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":av(aH,["listName","message"]);break;case"AddList":av(aH,["listName","description","templateID"]);break;case"AddListFromFeature":av(aH,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":av(aH,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":av(aH,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":av(aH,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":av(aH,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":av(aH,["listName","listItemID","url"]);break;case"DeleteContentType":av(aH,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":av(aH,["listName","contentTypeId","documentUri"]);break;case"DeleteList":av(aH,["listName"]);break;case"GetAttachmentCollection":av(aH,["listName",["listItemID","ID"]]);break;case"GetList":av(aH,["listName"]);break;case"GetListAndView":av(aH,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":av(aH,["listName","contentTypeId"]);break;case"GetListContentTypes":av(aH,["listName"]);break;case"GetListItems":av(aH,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":av(aH,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":av(aH,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:false},{name:"contains",sendNull:false}]);break;case"GetVersionCollection":av(aH,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":av(aH,["pageUrl"]);break;case"UpdateContentType":av(aH,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":av(aH,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":av(aH,["listName","contentTypeId","newDocument"]);break;case"UpdateList":av(aH,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":av(aH,["listName"]);if(typeof aH.updates!=="undefined"&&aH.updates.length>0){av(aH,["updates"])}else{T.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+aH.batchCmd+"'>";for(aG=0;aG<aH.valuepairs.length;aG++){T.payload+="<Field Name='"+aH.valuepairs[aG][0]+"'>"+L(aH.valuepairs[aG][1])+"</Field>"}if(aH.batchCmd!=="New"){T.payload+="<Field Name='ID'>"+aH.ID+"</Field>"}T.payload+="</Method></Batch></updates>"}break;case"AddMeeting":av(aH,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":av(aH,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":av(aH,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":av(aH,["title"]);break;case"ResolvePrincipals":av(aH,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":av(aH,["searchText","maxResults","principalType"]);break;case"AddPermission":av(aH,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":av(aH,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":av(aH,["objectName","objectType"]);break;case"RemovePermission":av(aH,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":av(aH,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":av(aH,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":T.opheader="<"+aH.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aH.operation;break;case"GetQuerySuggestions":T.opheader="<"+aH.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aH.operation;T.payload+=ay("queryXml",j(aH.queryXml));break;case"GetSearchMetadata":T.opheader="<"+aH.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aH.operation;break;case"Query":T.payload+=ay("queryXml",j(aH.queryXml));break;case"QueryEx":T.opheader="<"+aH.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aH.operation;T.payload+=ay("queryXml",j(aH.queryXml));break;case"Registration":T.payload+=ay("registrationXml",j(aH.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":av(aH,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":av(aH,["strFolderUrl"]);break;case"GetAttachments":av(aH,["strListName","strItemId"]);break;case"SiteDataGetList":av(aH,["strListName"]);T=k(T,aH.operation);break;case"SiteDataGetListCollection":T=k(T,aH.operation);break;case"SiteDataGetSite":T=k(T,aH.operation);break;case"SiteDataGetSiteUrl":av(aH,["Url"]);T=k(T,aH.operation);break;case"SiteDataGetWeb":T=k(T,aH.operation);break;case"CreateWeb":av(aH,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":av(aH,["url"]);break;case"GetSite":av(aH,["SiteUrl"]);break;case"GetSiteTemplates":av(aH,["LCID","TemplateList"]);break;case"AddComment":av(aH,["url","comment","isHighPriority","title"]);break;case"AddTag":av(aH,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":av(aH,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":av(aH,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":av(aH,["userAccountName","url"]);break;case"CountCommentsOnUrl":av(aH,["url"]);break;case"CountRatingsOnUrl":av(aH,["url"]);break;case"CountTagsOfUser":av(aH,["userAccountName"]);break;case"DeleteComment":av(aH,["url","lastModifiedTime"]);break;case"DeleteRating":av(aH,["url"]);break;case"DeleteTag":av(aH,["url","termID"]);break;case"DeleteTagByKeyword":av(aH,["url","keyword"]);break;case"DeleteTags":av(aH,["url"]);break;case"GetAllTagTerms":av(aH,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":av(aH,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":av(aH,["termID"]);break;case"GetAllTagUrlsByKeyword":av(aH,["keyword"]);break;case"GetCommentsOfUser":av(aH,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":av(aH,["userAccountName","url"]);break;case"GetCommentsOnUrl":av(aH,["url","maximumItemsToReturn","startIndex"]);if(typeof aH.excludeItemsTime!=="undefined"&&aH.excludeItemsTime.length>0){T.payload+=ay("excludeItemsTime",aH.excludeItemsTime)}break;case"GetRatingAverageOnUrl":av(aH,["url"]);break;case"GetRatingOfUserOnUrl":av(aH,["userAccountName","url"]);break;case"GetRatingOnUrl":av(aH,["url"]);break;case"GetRatingsOfUser":av(aH,["userAccountName"]);break;case"GetRatingsOnUrl":av(aH,["url"]);break;case"GetSocialDataForFullReplication":av(aH,["userAccountName"]);break;case"GetTags":av(aH,["url"]);break;case"GetTagsOfUser":av(aH,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":av(aH,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":av(aH,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":av(aH,["url","maximumItemsToReturn"]);break;case"GetTagUrls":av(aH,["termID"]);break;case"GetTagUrlsByKeyword":av(aH,["keyword"]);break;case"GetTagUrlsOfUser":av(aH,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":av(aH,["keyword","userAccountName"]);break;case"SetRating":av(aH,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":av(aH,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":av(aH,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":av(aH,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":av(aH,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":av(aH,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":av(aH,["termIds","lcid"]);break;case"GetTermsByLabel":av(aH,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":av(aH,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":av(aH,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":av(aH,["groupName","roleName"]);break;case"AddRole":av(aH,["roleName","description","permissionMask"]);break;case"AddRoleDef":av(aH,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":av(aH,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":av(aH,["roleName","usersInfoXml"]);break;case"AddUserToGroup":av(aH,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":av(aH,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":av(aH,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":av(aH,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":av(aH,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":av(aH,["groupName"]);break;case"GetRoleCollection":av(aH,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":av(aH,["groupName"]);break;case"GetRoleCollectionFromUser":av(aH,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":av(aH,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":av(aH,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":av(aH,["groupName"]);break;case"GetUserCollectionFromRole":av(aH,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":av(aH,["userLoginName"]);break;case"GetUserLoginFromEmail":av(aH,["emailXml"]);break;case"RemoveGroup":av(aH,["groupName"]);break;case"RemoveGroupFromRole":av(aH,["roleName","groupName"]);break;case"RemoveRole":av(aH,["roleName"]);break;case"RemoveUserCollectionFromGroup":av(aH,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":av(aH,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":av(aH,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":av(aH,["groupName","userLoginName"]);break;case"RemoveUserFromRole":av(aH,["roleName","userLoginName"]);break;case"RemoveUserFromSite":av(aH,["userLoginName"]);break;case"RemoveUserFromWeb":av(aH,["userLoginName"]);break;case"UpdateGroupInfo":av(aH,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":av(aH,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":av(aH,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":av(aH,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":av(aH,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":av(aH,["accountName","name","url","group","privacy"]);break;case"AddMembership":av(aH,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":av(aH,["accountName","name","url"]);break;case"CreateMemberGroup":av(aH,["membershipInfo"]);break;case"CreateUserProfileByAccountName":av(aH,["accountName"]);break;case"GetCommonColleagues":av(aH,["accountName"]);break;case"GetCommonManager":av(aH,["accountName"]);break;case"GetCommonMemberships":av(aH,["accountName"]);break;case"GetInCommon":av(aH,["accountName"]);break;case"GetPropertyChoiceList":av(aH,["propertyName"]);break;case"GetUserColleagues":av(aH,["accountName"]);break;case"GetUserLinks":av(aH,["accountName"]);break;case"GetUserMemberships":av(aH,["accountName"]);break;case"GetUserPinnedLinks":av(aH,["accountName"]);break;case"GetUserProfileByGuid":av(aH,["guid"]);break;case"GetUserProfileByIndex":av(aH,["index"]);break;case"GetUserProfileByName":if(typeof aH.accountName!=="undefined"&&aH.accountName.length>0){av(aH,[["AccountName","accountName"]])}else{av(aH,["AccountName"])}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":av(aH,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":av(aH,["accountName","newData"]);break;case"RemoveAllColleagues":av(aH,["accountName"]);break;case"RemoveAllLinks":av(aH,["accountName"]);break;case"RemoveAllMemberships":av(aH,["accountName"]);break;case"RemoveAllPinnedLinks":av(aH,["accountName"]);break;case"RemoveColleague":av(aH,["accountName","colleagueAccountName"]);break;case"RemoveLink":av(aH,["accountName","id"]);break;case"RemoveMembership":av(aH,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":av(aH,["accountName","id"]);break;case"UpdateColleaguePrivacy":av(aH,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":av(aH,["accountName","data"]);break;case"UpdateMembershipPrivacy":av(aH,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":av(aH,["accountName","data"]);break;case"DeleteAllVersions":av(aH,["fileName"]);break;case"DeleteVersion":av(aH,["fileName","fileVersion"]);break;case"GetVersions":av(aH,["fileName"]);break;case"RestoreVersion":av(aH,["fileName","fileVersion"]);break;case"AddView":av(aH,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":av(aH,["listName","viewName"]);break;case"GetView":av(aH,["listName","viewName"]);break;case"GetViewCollection":av(aH,["listName"]);break;case"GetViewHtml":av(aH,["listName","viewName"]);break;case"UpdateView":av(aH,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":av(aH,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":av(aH,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":av(aH,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"GetWebPart2":av(aH,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":av(aH,["documentName","behavior"]);break;case"GetWebPartProperties":av(aH,["pageUrl","storage"]);break;case"GetWebPartProperties2":av(aH,["pageUrl","storage","behavior"]);break;case"Webs.CreateContentType":av(aH,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":av(aH,["webUrl"]);break;case"GetContentType":av(aH,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":av(aH,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":av(aH,["objectUrl"]);break;case"GetWeb":av(aH,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":av(aH,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":av(aH,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":av(aH,[["pageUrl","pageURL"]]);break;case"AlterToDo":av(aH,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":av(aH,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":av(aH,["item"]);break;case"GetToDosForItem":av(aH,["item"]);break;case"GetWorkflowDataForItem":av(aH,["item"]);break;case"GetWorkflowTaskData":av(aH,["item","listId","taskId"]);break;case"StartWorkflow":av(aH,["item","templateId","workflowParameters"]);break;default:break}var aK=T.header+T.opheader+T.payload+T.opfooter+T.footer;var aI;if(aH.cacheXML){aI=B[aK]}if(typeof aI==="undefined"){B[aK]=am.ajax({url:aJ,async:aH.async,beforeSend:function(i){if(U[aH.operation][1]){i.setRequestHeader("SOAPAction",ac)}},type:"POST",data:aK,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(aL,i){if(am.isFunction(aH.completefunc)){aH.completefunc(aL,i)}}});return B[aK]}else{if(am.isFunction(aH.completefunc)){aH.completefunc(aI,null)}return aI}};am.fn.SPServices.defaults={cacheXML:false,operation:"",webURL:"",makeViewDefault:false,CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:true,nonGregorian:false,fClaim:false,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:false,isPrivate:false,rating:1,maxResults:10,principalType:"User",async:true,completefunc:null};am.fn.SPServices.SPGetCurrentSite=function(){if(ae.thisSite.length>0){return ae.thisSite}var i=T.header+"<WebUrlFromPageUrl xmlns='"+ad+"/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+T.footer;am.ajax({async:false,url:"/_vti_bin/Webs.asmx",type:"POST",data:i,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(aE){ae.thisSite=am(aE.responseXML).find("WebUrlFromPageUrlResult").text()}});return ae.thisSite};am.fn.SPServices.SPCascadeDropdowns=function(aM){var aE=am.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:am().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:false,selectSingleOption:false,matchOnId:false,completefunc:null,debug:false},aM);var aG=false;var aK="SPServices.SPCascadeDropdowns";var aH=am().SPServices.SPDropdownCtl({displayName:aE.parentColumn});if(aH.Obj.html()===null&&aE.debug){X(aK,"parentColumn: "+aE.parentColumn,aj);return}var i=am().SPServices.SPDropdownCtl({displayName:aE.childColumn});if(i.Obj.html()===null&&aE.debug){X(aK,"childColumn: "+aE.childColumn,aj);return}if(aE.simpleChild===true&&i.Type===Y.complex){am().SPServices.SPComplexToSimpleDropdown({columnName:aE.childColumn});i=am().SPServices.SPDropdownCtl({displayName:aE.childColumn})}var aL,aJ;am().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aE.listName,completefunc:function(aN){am(aN.responseXML).find("Fields").each(function(){am(this).find("Field[DisplayName='"+aE.childColumn+"']").each(function(){aL=(am(this).attr("Required")==="TRUE")?true:false;aJ=am(this).attr("StaticName");return false})})}});var aI={opt:aE,childSelect:i,childColumnStatic:aJ,childColumnRequired:aL};var aF=aH.Obj.data("SPCascadeDropdownsChildColumns");if(typeof aF==="undefined"){aH.Obj.data("SPCascadeDropdownsChildColumns",[aI])}else{aF.push(aI);aH.Obj.data("SPCascadeDropdownsChildColumns",aF);aG=true}if(!aG){switch(aH.Type){case Y.simple:aH.Obj.bind("change",function(){aB(aE.parentColumn,aH)});break;case Y.complex:aH.optHid.bind("propertychange",function(){aB(aE.parentColumn,aH)});break;case Y.multiSelect:am(aH.master.candidateControl).bind("dblclick",function(){aB(aE.parentColumn,aH)});am(aH.master.resultControl).bind("dblclick",function(){aB(aE.parentColumn,aH)});am(aH.master.addControl).bind("click",function(){aB(aE.parentColumn,aH)});am(aH.master.removeControl).bind("click",function(){aB(aE.parentColumn,aH)});break;default:break}}aB(aE.parentColumn,aH)};function aB(aL,aG){var aM="";var aF;var aI=null;var aK;var aH;var aJ;var aE;var i=aG.Obj.data("SPCascadeDropdownsChildColumns");am(i).each(function(){var aR=this.opt;var aP=this.childSelect;var aU=this.childColumnStatic;var aQ=this.childColumnRequired;aF=c(aG,aR.matchOnId);var aO=aF.join(";#");if(aG.Obj.data("SPCascadeDropdown_Selected_"+aU)===aO){return}aG.Obj.data("SPCascadeDropdown_Selected_"+aU,aO);aI=c(aP,true);var aT=(aR.relationshipListSortColumn.length>0)?aR.relationshipListSortColumn:aR.relationshipListChildColumn;var aN="<Query><OrderBy><FieldRef Name='"+aT+"'/></OrderBy><Where><And>";if(aR.CAMLQuery.length>0){aN+="<And>"}if(aF.length===0){aN+="<Eq><FieldRef Name='"+aR.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(aF.length===1){aN+="<Eq><FieldRef Name='"+aR.relationshipListParentColumn+(aR.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aF[0])+"</Value></Eq>"}else{var aS=(aF.length>2)?true:false;for(O=0;O<(aF.length-1);O++){aN+="<Or>"}for(O=0;O<aF.length;O++){aN+="<Eq><FieldRef Name='"+aR.relationshipListParentColumn+(aR.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aF[O])+"</Value></Eq>";if(O>0&&(O<(aF.length-1))&&aS){aN+="</Or>"}}aN+="</Or>"}}if(aR.CAMLQuery.length>0){aN+=aR.CAMLQuery+"</And>"}aN+="<IsNotNull><FieldRef Name='"+aR.relationshipListChildColumn+"' /></IsNotNull>";aN+="</And></Where></Query>";am().SPServices({operation:"GetListItems",async:false,webURL:aR.relationshipWebURL,listName:aR.relationshipList,CAMLQuery:aN,CAMLViewFields:"<ViewFields><FieldRef Name='"+aR.relationshipListParentColumn+"' /><FieldRef Name='"+aR.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:aR.CAMLQueryOptions,completefunc:function(aV){am(aV.responseXML).find("errorstring").each(function(){var aX="SPServices.SPCascadeDropdowns";var aW=am(this).text();if(aR.debug&&aW==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aX,"relationshipListParentColumn: "+aR.relationshipListParentColumn+" or "+"relationshipListChildColumn: "+aR.relationshipListChildColumn,"Not found in relationshipList "+aR.relationshipList)}else{if(aR.debug&&aW==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aX,"relationshipList: "+aR.relationshipList,"List not found")}}return});switch(aP.Type){case Y.simple:am(aP.Obj).find("option").remove();if(!aQ&&(aR.promptText.length>0)){aP.Obj.append("<option value='0'>"+aR.promptText.replace(/\{0\}/g,aR.childColumn)+"</option>")}else{if(!aQ){aP.Obj.append("<option value='0'>"+aR.noneText+"</option>")}}break;case Y.complex:aM=aQ?"":aR.noneText+"|0";aP.Obj.val("");break;case Y.multiSelect:am(aP.master.candidateControl).find("option").remove();aK="";break;default:break}aH=parseFloat(am(aV.responseXML).SPFilterNode("rs:data").attr("ItemCount"));am(aV.responseXML).SPFilterNode("z:row").each(function(){var aX={};var aW=am(this).attr("ows_"+aR.relationshipListChildColumn);if(typeof aW!=="undefined"&&aW.indexOf(";#")>0){aX=new n(aW)}else{aX.id=am(this).attr("ows_ID");aX.value=aW}if(isNaN(aX.id)){aX.id=am(this).attr("ows_ID")}aJ=aX.id;aE=aX.value;switch(aP.Type){case Y.simple:var aY=(am(this).attr("ows_ID")===aI[0])?" selected='selected'":"";aP.Obj.append("<option"+aY+" value='"+aX.id+"'>"+aX.value+"</option>");break;case Y.complex:if(aX.id===aI[0]){aP.Obj.val(aX.value)}aM=aM+((aM.length>0)?"|":"")+aX.value+"|"+aX.id;break;case Y.multiSelect:am(aP.master.candidateControl).append("<option value='"+aX.id+"'>"+aX.value+"</option>");aK+=aX.id+"|t"+aX.value+"|t |t |t";break;default:break}});switch(aP.Type){case Y.simple:aP.Obj.trigger("change");if(aH===1&&aR.selectSingleOption===true){am(aP.Obj).find("option[value!='0']:first").attr("selected","selected")}break;case Y.complex:aP.Obj.attr("choices",aM);if(aH===1&&aR.selectSingleOption===true){am(aP.Obj).val(aE);aP.optHid.val(aJ)}if(aP.Obj.val()===""){aP.optHid.val("")}break;case Y.multiSelect:aP.master.data="";aP.MultiLookupPickerdata.val(aK);am(aP.master.resultControl).find("option").each(function(){var aW=am(this);aW.prop("selected",true);am(aP.master.candidateControl).find("option[value='"+aW.val()+"']").each(function(){aW.prop("selected",false)})});GipRemoveSelectedItems(aP.master);am(aP.master.candidateControl).find("option").each(function(){var aW=am(this);am(aP.master.resultControl).find("option[value='"+aW.val()+"']").each(function(){aW.remove()})});GipAddSelectedItems(aP.master);aP.master.data=GipGetGroupData(aK);am(aP.master.candidateControl).trigger("dblclick");break;default:break}}});if(aR.completefunc!==null){aR.completefunc()}})}am.fn.SPServices.SPComplexToSimpleDropdown=function(aG){var aH=am.extend({},{columnName:"",completefunc:null,debug:false},aG);var aJ=am().SPServices.SPDropdownCtl({displayName:aH.columnName});if(aJ.Obj.html()===null&&aH.debug){X("SPServices.SPComplexToSimpleDropdown","columnName: "+aH.columnName,aj);return}if(aJ.Type!==Y.complex){return}var aK=am(aJ.Obj).attr("choices").split("|");var aF=aJ.optHid.val();var aE=af("SPComplexToSimpleDropdown",aH.columnName);var i="<select id='"+aE+"' title='"+aH.columnName+"'>";for(O=0;O<aK.length;O=O+2){var aI=(aK[O+1]===aF)?" selected='selected' ":" ";i+="<option"+aI+"value='"+aK[O+1]+"'>"+aK[O]+"</option>"}i+="</select>";am(aJ.Obj).closest("td").prepend(i);am(aJ.Obj).closest("span").find("img").remove();am(aJ.Obj).closest("span").find("input").hide();am("#"+aE).change(function(){var aL=am(this).val();aJ.optHid.val(aL);am(aJ.Obj).val(am(this).find("option[value='"+(aL!=="0"?aL:"")+"']").html())});am("#"+aE).trigger("change");if(aH.completefunc!==null){aH.completefunc()}};am.fn.SPServices.SPDisplayRelatedInfo=function(aE){var aG=am.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:false,completefunc:null,debug:false},aE);var i;var aF=[];var aJ;var aI="SPServices.SPDisplayRelatedInfo";var aH=am().SPServices.SPDropdownCtl({displayName:aG.columnName});if(aH.Obj.html()===null&&aG.debug){X(aI,"columnName: "+aG.columnName,aj);return}i=af("SPDisplayRelatedInfo",aG.columnName);am().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aG.relatedWebURL,listName:aG.relatedList,completefunc:function(aK){am(aK.responseXML).find("faultcode").each(function(){if(aG.debug){X(aI,"relatedList: "+aG.relatedList,"List not found");return}});aJ=am(aK.responseXML).find("List");for(O=0;O<aG.relatedColumns.length;O++){aF[aG.relatedColumns[O]]=am(aK.responseXML).find("Fields > Field[Name='"+aG.relatedColumns[O]+"']")}aF[aG.relatedListColumn]=am(aK.responseXML).find("Fields > Field[Name='"+aG.relatedListColumn+"']")}});switch(aH.Type){case Y.simple:aH.Obj.bind("change",function(){ah(aG,i,aJ,aF)});break;case Y.complex:aH.optHid.bind("propertychange",function(){ah(aG,i,aJ,aF)});break;case Y.multiSelect:if(aG.debug){X(aI,"columnName: "+aG.columnName,"Multi-select columns not supported by this function")}break;default:break}ah(aG,i,aJ,aF)};function ah(aF,aJ,aL,aG){var aM=null;var aI="SPServices.SPDisplayRelatedInfo";var aH=am().SPServices.SPDropdownCtl({displayName:aF.columnName});aM=c(aH,aF.matchOnId);if(aH.Type===Y.complex&&aF.numChars>0&&aM[0].length<aF.numChars){return}if(aH.Obj.attr("showRelatedSelected")===aM[0]){return}aH.Obj.attr("showRelatedSelected",aM[0]);am("#"+aJ).remove();aH.Obj.parent().append("<div id="+aJ+"></div>");var i="<Query><Where>";if(aF.CAMLQuery.length>0){i+="<And>"}var aE=aG[aF.relatedListColumn].attr("Type");if(aE==="Lookup"){i+="<Eq><FieldRef Name='"+aF.relatedListColumn+(aF.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aM[0])+"</Value></Eq>"}else{i+="<Eq><FieldRef Name='"+(aF.matchOnId?"ID' /><Value Type='Counter'>":aF.relatedListColumn+"'/><Value Type='Text'>")+L(aM[0])+"</Value></Eq>"}if(aF.CAMLQuery.length>0){i+=aF.CAMLQuery+"</And>"}i+="</Where></Query>";var aK=" ";for(O=0;O<aF.relatedColumns.length;O++){aK+="<FieldRef Name='"+aF.relatedColumns[O]+"' />"}am().SPServices({operation:"GetListItems",async:false,webURL:aF.relatedWebURL,listName:aF.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+aK+"</ViewFields>",CAMLRowLimit:0,completefunc:function(aO){am(aO.responseXML).find("errorstring").each(function(){var aP=am(this).text();if(aF.debug&&aP==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aI,"relatedListColumn: "+aF.relatedListColumn,"Column not found in relatedList "+aF.relatedList)}else{if(aF.debug&&aP==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aI,"relatedList: "+aF.relatedList,"List not found")}}return});var aN;switch(aF.displayFormat){case"table":aN="<table>";aN+="<tr>";for(O=0;O<aF.relatedColumns.length;O++){if(typeof aG[aF.relatedColumns[O]]==="undefined"&&aF.debug){X(aI,"columnName: "+aF.relatedColumns[O],"Column not found in relatedList");return}aN+="<th class='"+aF.headerCSSClass+"'>"+aG[aF.relatedColumns[O]].attr("DisplayName")+"</th>"}aN+="</tr>";am(aO.responseXML).SPFilterNode("z:row").each(function(){aN+="<tr>";for(O=0;O<aF.relatedColumns.length;O++){aN+="<td class='"+aF.rowCSSClass+"'>"+W(aL,aG[aF.relatedColumns[O]],am(this).attr("ows_"+aF.relatedColumns[O]),aF)+"</td>"}aN+="</tr>"});aN+="</table>";break;case"list":aN="<table>";am(aO.responseXML).SPFilterNode("z:row").each(function(){for(O=0;O<aF.relatedColumns.length;O++){if(typeof aG[aF.relatedColumns[O]]==="undefined"&&aF.debug){X(aI,"columnName: "+aF.relatedColumns[O],"Column not found in relatedList");return}aN+="<tr>";aN+="<th class='"+aF.headerCSSClass+"'>"+aG[aF.relatedColumns[O]].attr("DisplayName")+"</th>";aN+="<td class='"+aF.rowCSSClass+"'>"+W(aL,aG[aF.relatedColumns[O]],am(this).attr("ows_"+aF.relatedColumns[O]),aF)+"</td>";aN+="</tr>"}});aN+="</table>";break;default:break}am("#"+aJ).html(aN)}});if(aF.completefunc!==null){aF.completefunc()}}am.fn.SPServices.SPFilterDropdown=function(aN){var aE=am.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:true,columnName:"",listName:am().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:false},aN);var aM="";var aL=null;var aK;var aJ;var aI="SPServices.SPFilterDropdown";var aH=am().SPServices.SPDropdownCtl({displayName:aE.columnName});if(aH.Obj.html()===null&&aE.debug){X(aI,"columnName: "+aE.columnName,aj);return}aL=c(aH,true);var aG=(aE.relationshipListSortColumn.length>0)?aE.relationshipListSortColumn:aE.relationshipListColumn;var aF=(aE.relationshipListSortAscending===true)?"":"Ascending='FALSE'";var i="<Query><OrderBy><FieldRef Name='"+aG+"' "+aF+"/></OrderBy><Where>";if(aE.CAMLQuery.length>0){i+=aE.CAMLQuery}i+="</Where></Query>";am().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aE.listName,completefunc:function(aO){am(aO.responseXML).find("Fields").each(function(){am(this).find("Field[DisplayName='"+aE.columnName+"']").each(function(){aJ=(am(this).attr("Required")==="TRUE")?true:false;return false})})}});am().SPServices({operation:"GetListItems",async:false,webURL:aE.relationshipWebURL,listName:aE.relationshipList,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='"+aE.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:aE.CAMLQueryOptions,completefunc:function(aO){am(aO.responseXML).find("errorstring").each(function(){var aP=am(this).text();if(aE.debug&&aP==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aI,"relationshipListColumn: "+aE.relationshipListColumn,"Not found in relationshipList "+aE.relationshipList)}else{if(aE.debug&&aP==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aI,"relationshipList: "+aE.relationshipList,"List not found")}}return});switch(aH.Type){case Y.simple:am(aH.Obj).find("option").remove();if(!aJ&&(aE.promptText.length>0)){aH.Obj.append("<option value='0'>"+aE.promptText.replace(/\{0\}/g,aE.columnName)+"</option>")}else{if(!aJ){aH.Obj.append("<option value='0'>"+aE.noneText+"</option>")}}break;case Y.complex:aM=aJ?"":aE.noneText+"|0";aH.Obj.val("");break;case Y.multiSelect:am(aH.master.candidateControl).find("option").remove();aK="";break;default:break}am(aO.responseXML).SPFilterNode("z:row").each(function(){var aQ={};var aP=am(this).attr("ows_"+aE.relationshipListColumn);if(typeof aP!=="undefined"&&aP.indexOf(";#")>0){aQ=new n(aP)}else{aQ.id=am(this).attr("ows_ID");aQ.value=aP}if(isNaN(aQ.id)){aQ.id=am(this).attr("ows_ID")}switch(aH.Type){case Y.simple:var aR=(am(this).attr("ows_ID")===aL[0])?" selected='selected'":"";aH.Obj.append("<option"+aR+" value='"+aQ.id+"'>"+aQ.value+"</option>");break;case Y.complex:if(aQ.id===aL[0]){aH.Obj.val(aQ.value)}aM=aM+((aM.length>0)?"|":"")+aQ.value+"|"+aQ.id;break;case Y.multiSelect:am(aH.master.candidateControl).append("<option value='"+aQ.id+"'>"+aQ.value+"</option>");aK+=aQ.id+"|t"+aQ.value+"|t |t |t";break;default:break}});switch(aH.Type){case Y.simple:aH.Obj.trigger("change");break;case Y.complex:aH.Obj.attr("choices",aM);aH.Obj.trigger("propertychange");break;case Y.multiSelect:aH.master.data="";aH.MultiLookupPickerdata.val(aK);am(aH.master.resultControl).find("option").each(function(){var aP=am(this);am(this).attr("selected","selected");am(aH.master.candidateControl).find("option").each(function(){if(am(this).html()===aP.html()){aP.removeAttr("selected")}})});GipRemoveSelectedItems(aH.master);am(aH.master.candidateControl).find("option").each(function(){var aP=am(this);am(aH.master.resultControl).find("option").each(function(){if(am(this).html()===aP.html()){aP.remove()}})});GipAddSelectedItems(aH.master);aH.master.data=GipGetGroupData(aK);am(aH.master.candidateControl).trigger("dblclick");break;default:break}}});if(aE.completefunc!==null){aE.completefunc()}};am.fn.SPServices.SPDebugXMLHttpResult=function(aF){var aH=am.extend({},{node:null,indent:0},aF);var aG;var aJ=3;var aI=4;var aE="";aE+="<table class='ms-vb' style='margin-left:"+aH.indent*3+"px;' width='100%'>";if(aH.node.nodeName==="DisplayPattern"){aE+="<tr><td width='100px' style='font-weight:bold;'>"+aH.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aH.node.xml+"</textarea></td></tr>"}else{if(!aH.node.hasChildNodes()){aE+="<tr><td width='100px' style='font-weight:bold;'>"+aH.node.nodeName+"</td><td>"+((aH.node.nodeValue!==null)?N(aH.node.nodeValue):"&nbsp;")+"</td></tr>";if(aH.node.attributes){aE+="<tr><td colspan='99'>"+t(aH.node)+"</td></tr>"}}else{if(aH.node.hasChildNodes()&&aH.node.firstChild.nodeType===aI){aE+="<tr><td width='100px' style='font-weight:bold;'>"+aH.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aH.node.parentNode.text+"</textarea></td></tr>"}else{if(aH.node.hasChildNodes()&&aH.node.firstChild.nodeType===aJ){aE+="<tr><td width='100px' style='font-weight:bold;'>"+aH.node.nodeName+"</td><td>"+N(aH.node.firstChild.nodeValue)+"</td></tr>"}else{aE+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+aH.node.nodeName+"</td></tr>";if(aH.node.attributes){aE+="<tr><td colspan='99'>"+t(aH.node)+"</td></tr>"}aE+="<tr><td>";for(aG=0;aG<aH.node.childNodes.length;aG++){aE+=am().SPServices.SPDebugXMLHttpResult({node:aH.node.childNodes.item(aG),indent:aH.indent+1})}aE+="</td></tr>"}}}}aE+="</table>";return aE};am.fn.SPServices.SPGetCurrentUser=function(aH){var aJ=am.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:false},aH);if(aJ.fieldName==="ID"&&typeof ae.thisUserId!=="undefined"){return ae.thisUserId}var aF="";var aI={};var aK=aJ.fieldNames.length>0?aJ.fieldNames.length:1;var aG;var aE=aJ.webURL.length>0?aJ.webURL:am().SPServices.SPGetCurrentSite();am.ajax({async:false,url:aE+"/_layouts/userdisp.aspx?Force=True&"+new Date().getTime(),complete:function(aL){aG=aL}});for(O=0;O<aK;O++){if(aJ.fieldNames[O]==="ID"){aF=ae.thisUserId}else{var i;if(aK>1){i=RegExp('FieldInternalName="'+aJ.fieldNames[O]+'"',"gi")}else{i=RegExp('FieldInternalName="'+aJ.fieldName+'"',"gi")}am(aG.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(am(this).html())){switch(am(this).attr("id")){case"SPFieldText":aF=am(this).text();break;case"SPFieldNote":aF=am(this).find("div").html();break;case"SPFieldURL":aF=am(this).find("img").attr("src");break;default:aF=am(this).text();break}return false}})}if(aJ.fieldNames[O]!=="ID"){aF=(typeof aF!=="undefined")?aF.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null}if(aK>1){aI[aJ.fieldNames[O]]=aF}}return(aK>1)?aI:aF};am.fn.SPServices.SPLookupAddNew=function(aL){var aG=am.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:false,ContentTypeID:"",completefunc:null,debug:false},aL);var aI="SPServices.SPLookupAddNew";var aF=am().SPServices.SPDropdownCtl({displayName:aG.lookupColumn});if(aF.Obj.html()===null&&aG.debug){X(aI,"lookupColumn: "+aG.lookupColumn,aj);return}var i="";var aK="";var aE="";am().SPServices({operation:"GetList",async:false,cacheXML:true,listName:am().SPServices.SPListNameFromUrl(),completefunc:function(aM){am(aM.responseXML).find("Field[DisplayName='"+aG.lookupColumn+"']").each(function(){aE=am(this).attr("StaticName");am().SPServices({operation:"GetList",async:false,cacheXML:true,listName:am(this).attr("List"),completefunc:function(aN){am(aN.responseXML).find("List").each(function(){aK=am(this).attr("WebFullUrl");aK=aK!==Q?aK+Q:aK})}});i=D(am(this).attr("List"),"NewForm");return false})}});if(aK.length===0&&aG.debug){X(aI,"lookupColumn: "+aG.lookupColumn,"This column does not appear to be a lookup column");return}if(i.length>0){var aJ=aK+i;aJ+=aG.newWindow?((aG.ContentTypeID.length>0)?"?ContentTypeID="+aG.ContentTypeID:"")+"' target='_blank'":"?"+((aG.ContentTypeID.length>0)?"ContentTypeID="+aG.ContentTypeID+"&":"")+"Source="+A(location.href)+"'";var aH="<div id='SPLookupAddNew_"+aE+"'>"+"<a href='"+aJ+">"+aG.promptText.replace(/\{0\}/g,aG.lookupColumn)+"</a></div>";am(aF.Obj).parents("td.ms-formbody").append(aH)}else{if(aG.debug){X(aI,"lookupColumn: "+aG.lookupColumn,"NewForm cannot be found");return}}if(aG.completefunc!==null){aG.completefunc()}};am.fn.SPServices.SPGetLastItemId=function(aE){var aG=am.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},aE);var aF;var aH=0;am().SPServices({operation:"GetUserInfo",webURL:aG.webURL,async:false,userLoginName:(aG.userAccount!=="")?aG.userAccount:am().SPServices.SPGetCurrentUser(),completefunc:function(aI){am(aI.responseXML).find("User").each(function(){aF=am(this).attr("ID")})}});var i="<Query><Where>";if(aG.CAMLQuery.length>0){i+="<And>"}i+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+aF+"</Value></Eq>";if(aG.CAMLQuery.length>0){i+=aG.CAMLQuery+"</And>"}i+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";am().SPServices({operation:"GetListItems",async:false,webURL:aG.webURL,listName:aG.listName,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(aI){am(aI.responseXML).SPFilterNode("z:row").each(function(){aH=am(this).attr("ows_ID")})}});return aH};am.fn.SPServices.SPRequireUnique=function(aE){var aF=am.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:false,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:false,completefunc:null},aE);var aJ=am().SPServices.SPGetQueryString();var aK=aJ.ID;ae.thisList=am().SPServices.SPListNameFromUrl();var aI="<span id='SPRequireUnique"+aF.columnStaticName+"' class='{0}'>{1}</span><br/>";var aH=aI.replace(/\{0\}/g,aF.initMsgCSSClass).replace(/\{1\}/g,aF.initMsg);var aG=am().SPServices.SPGetDisplayFromStatic({listName:ae.thisList,columnStaticName:aF.columnStaticName});var i=am("input[Title='"+aG+"']");am(i).parent().append(aH);am(i).blur(function(){var aN=[];var aO=am(this).val();if(aO.length===0){return false}am().SPServices({operation:"GetListItems",async:false,listName:ae.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+aF.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+aF.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(aQ){var aP=aF.ignoreCase?aO.toUpperCase():aO;am(aQ.responseXML).SPFilterNode("z:row").each(function(){var aR=aF.ignoreCase?am(this).attr("ows_"+aF.columnStaticName).toUpperCase():am(this).attr("ows_"+aF.columnStaticName);if((aP===aR)&&(am(this).attr("ows_ID")!==aK)){aN.push([am(this).attr("ows_ID"),am(this).attr("ows_"+aF.columnStaticName)])}})}});var aM=aF.initMsg;am("span#SPRequireUnique"+aF.columnStaticName).html(aM).attr("class",aF.initMsgCSSClass);am("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");if(aN.length>0){aM=aF.errMsg;am("span#SPRequireUnique"+aF.columnStaticName).html(aM).attr("class",aF.errMsgCSSClass);if(aF.duplicateAction===1){am("input[Title='"+aF.columnDisplayName+"']").focus();am("input[value='OK'], input[value='Save']").attr("disabled","disabled")}if(aF.showDupes){var aL=" "+aN.length+" duplicate item"+(aN.length>1?"s":"")+": ";for(O=0;O<aN.length;O++){aL+="<a href='DispForm.aspx?ID="+aN[O][0]+"&Source="+location.href+"'>"+aN[O][1]+"</a> "}am("span#SPRequireUnique"+aF.columnStaticName).append(aL)}}});if(aF.completefunc!==null){aF.completefunc()}};am.fn.SPServices.SPGetDisplayFromStatic=function(aE){var aF=am.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},aE);var i="";var aG={};var aH=aF.columnStaticNames.length>0?aF.columnStaticNames.length:1;am().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aF.webURL,listName:aF.listName,completefunc:function(aI){if(aH>1){for(O=0;O<aH;O++){aG[aF.columnStaticNames[O]]=am(aI.responseXML).find("Field[StaticName='"+aF.columnStaticNames[O]+"']").attr("DisplayName")}}else{i=am(aI.responseXML).find("Field[StaticName='"+aF.columnStaticName+"']").attr("DisplayName")}}});return(aH>1)?aG:i};am.fn.SPServices.SPGetStaticFromDisplay=function(i){var aF=am.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},i);var aE="";var aG={};var aH=aF.columnDisplayNames.length>0?aF.columnDisplayNames.length:1;am().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aF.webURL,listName:aF.listName,completefunc:function(aI){if(aH>1){for(O=0;O<aH;O++){aG[aF.columnDisplayNames[O]]=am(aI.responseXML).find("Field[DisplayName='"+aF.columnDisplayNames[O]+"']").attr("StaticName")}}else{aE=am(aI.responseXML).find("Field[DisplayName='"+aF.columnDisplayName+"']").attr("StaticName")}}});return(aH>1)?aG:aE};am.fn.SPServices.SPRedirectWithID=function(aF){var aG=am.extend({},{redirectUrl:"",qsParamName:"ID"},aF);ae.thisList=am().SPServices.SPListNameFromUrl();var aK=am().SPServices.SPGetQueryString();var aJ=aK.ID;var aI=aK.List;var aE=aK.RootFolder;var aH=aK.ContentTypeId;if(typeof aK.ID==="undefined"){aJ=am().SPServices.SPGetLastItemId({listName:ae.thisList});am("form[name='aspnetForm']").each(function(){var aM=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var aN=(typeof aK.Source==="string")?"Source="+aK.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var aL=[];if(typeof aI!=="undefined"){aL.push("List="+aI)}if(typeof aE!=="undefined"){aL.push("RootFolder="+aE)}if(typeof aH!=="undefined"){aL.push("ContentTypeId="+aH)}var aO=aM+((aL.length>0)?("?"+aL.join("&")+"&"):"?")+"Source="+aM+"?ID="+aJ+((aN.length>0)?("%26RealSource="+aK.Source):"")+((typeof aK.RedirectURL==="string")?("%26RedirectURL="+aK.RedirectURL):"");am(this).attr("action",aO)})}else{while(aK.ID===aJ){aJ=am().SPServices.SPGetLastItemId({listName:ae.thisList})}var i=(typeof aK.RedirectURL==="string")?aK.RedirectURL:aG.redirectUrl;location.href=i+"?"+aG.qsParamName+"="+aJ+((typeof aK.RealSource==="string")?("&Source="+aK.RealSource):"")}};am.fn.SPServices.SPSetMultiSelectSizes=function(aL){var i=am.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0,debug:false},aL);var aI="SPServices.SPSetMultiSelectSizes";var aH=am().SPServices.SPDropdownCtl({displayName:i.multiSelectColumn});if(aH.Obj.html()===null&&i.debug){X(aI,"multiSelectColumn: "+i.multiSelectColumn,aj);return}if(aH.Type!==Y.multiSelect&&i.debug){X(aI,"multiSelectColumn: "+i.multiSelectColumn,"Column is not multi-select.");return}var aJ=af("SPSetMultiSelectSizes",i.multiSelectColumn);var aG=am("<select id='"+aJ+"' ></select>").appendTo(aH.container);aG.css({"width":"auto","height":0,"visibility":"hidden"});am(aH.master.candidateControl).find("option").each(function(){aG.append("<option value='"+am(this).html()+"'>"+am(this).html()+"</option>")});am(aH.master.resultControl).find("option").each(function(){aG.append("<option value='"+am(this).val()+"'>"+am(this).html()+"</option>")});var aE=aG.width()+5;var aK=aE;if(i.minWidth>0||i.maxWidth>0){if(aE<i.minWidth){aE=i.minWidth}if(aK<i.minWidth){aK=i.minWidth}if(aK>i.maxWidth){aK=i.maxWidth}}var aF=aE;am(aH.master.candidateControl).css("width",aF+"px").parent().css("width",aK+"px");am(aH.master.resultControl).css("width",aF+"px").parent().css("width",aK+"px");aG.remove()};am.fn.SPServices.SPScriptAudit=function(aF){var aG=am.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},aF);var aE=[["New","NewForm.aspx",false],["Display","DispForm.aspx",false],["Edit","EditForm.aspx",false]];var aH;am("#"+aG.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>"+"<tr>"+"<th></th>"+"<th>List</th>"+"<th>Page Class</th>"+"<th>Page Type</th>"+"<th>Page</th>"+(aG.showSrc?"<th>Script References</th>":"")+"</tr>"+"</table>");am("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(aG.auditForms||aG.auditViews){am().SPServices({operation:"GetListCollection",webURL:aG.webURL,async:false,completefunc:function(aJ){am(aJ.responseXML).find("List").each(function(){aH=am(this);if((aG.listName.length===0)||(aH.attr("Title")===aG.listName)){if((aG.showHiddenLists&&aH.attr("Hidden")==="False")||!aG.showHiddenLists){if(aG.auditForms){am().SPServices({operation:"GetListContentTypes",webURL:aG.webURL,listName:aH.attr("ID"),async:false,completefunc:function(aK){am(aK.responseXML).find("ContentType").each(function(){if(am(this).attr("ID").substring(0,6)!=="0x0120"){var aM=am(this).find("FormUrls");for(O=0;O<aE.length;O++){am(aM).find(aE[O][0]).each(function(){aA(aG,aH,"Form",this.nodeName,((aG.webURL.length>0)?aG.webURL:am().SPServices.SPGetCurrentSite())+Q+am(this).text());aE[O][2]=true});if(!aE[O][2]){var aL=aH.attr("DefaultViewUrl");aA(aG,aH,"Form",aE[O][0],aL.substring(0,aL.lastIndexOf(Q)+1)+aE[O][1])}}for(O=0;O<aE.length;O++){aE[O][2]=false}}})}})}if(aG.auditViews){am().SPServices({operation:"GetViewCollection",webURL:aG.webURL,listName:aH.attr("ID"),async:false,completefunc:function(aK){am(aK.responseXML).find("View").each(function(){aA(aG,aH,"View",am(this).attr("DisplayName"),am(this).attr("Url"))})}})}}}})}})}var i=0;var aI=[];if(typeof aG.auditPagesListName==="string"){i=1;aI.push(aG.auditPagesListName)}else{i=aG.auditPagesListName.length;aI=aG.auditPagesListName}if(aG.auditPages){for(O=0;O<i;O++){am().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aG.webURL,listName:aI[O],completefunc:function(aJ){am(aJ.responseXML).find("List").each(function(){aH=am(this)})}});am().SPServices({operation:"GetListItems",async:false,webURL:aG.webURL,listName:aI[O],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(aJ){am(aJ.responseXML).SPFilterNode("z:row").each(function(){var aM=am(this).attr("ows_FileRef").split(";#")[1];var aK=am(this).attr("ows_Title");var aL=(typeof aK!=="undefined")?aK:"";if(aM.indexOf(".aspx")>0){aA(aG,aH,"Page",aL,Q+aM)}})}})}}am("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class")};function aA(aE,aF,aM,aI,aG){var aJ=0;var aL=0;var aH={};aH.type=[];aH.src=[];aH.script=[];var aK=RegExp("<script[\\s\\S]*?/script>","gi");am.ajax({type:"GET",url:aG,dataType:"text",async:false,success:function(aS){var aR;while(aR=aK.exec(aS)){var aN=al(aR,"language");var aT=al(aR,"type");var aP=al(aR,"src");if(aP!==null&&aP.length>0&&!an(aP)){aH.type.push((aN!==null&&aN.length>0)?aN:aT);aH.src.push(aP);aL++}}if((!aE.showNoScript&&(aH.type.length>0))||aE.showNoScript){var aQ=aG.substring(0,aG.lastIndexOf(Q)+1);var aO="<tr class=ms-alternating>"+"<td class=ms-vb-icon><a href='"+aF.attr("DefaultViewUrl")+"'><IMG border=0 src='"+aF.attr("ImageUrl")+"'width=16 height=16></A></TD>"+"<td class=ms-vb2><a href='"+aF.attr("DefaultViewUrl")+"'>"+aF.attr("Title")+((aF.attr("Hidden")==="True")?"(Hidden)":"")+"</td>"+"<td class=ms-vb2>"+aM+"</td>"+"<td class=ms-vb2>"+aI+"</td>"+"<td class=ms-vb2><a href='"+aG+"'>"+R(aG)+"</td>";if(aE.showSrc){var i;aO+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(aJ=0;aJ<aH.type.length;aJ++){i=(aH.src[aJ].substr(0,1)!==Q)?aQ+aH.src[aJ]:aH.src[aJ];aO+="<tr><td class=ms-vb2 width='30%'>"+aH.type[aJ]+"</td>";aO+="<td class=ms-vb2 width='70%'><a href='"+i+"'>"+R(aH.src[aJ])+"</td></tr>"}aO+="</table></td>"}am("#SPScriptAudit").append(aO)}}})}function al(aG,aE){var aF;var i=RegExp(aE+"=(\"([^\"]*)\")|('([^']*)')","gi");if(aF=i.exec(aG)){return aF[2]}return null}function an(aG){var aF;var aE=["WebResource.axd","_layouts"];for(aF=0;aF<aE.length;aF++){if(aG.indexOf(aE[aF])>-1){return true}}return false}am.fn.SPServices.SPArrangeChoices=function(aF){var aG=am.extend({},{listName:am().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:false},aF);var aI=false;var aH=[];var aE;var i=am().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aG.listName});i.done(function(){am(i.responseXML).find("Field[DisplayName='"+aG.columnName+"']").each(function(){aI=(am(this).attr("FillInChoice")==="TRUE")?true:false;return false});var aN=z(aG.columnName);var aL=am(aN).find("tr").length;var aK=0;var aM;var aJ;am(aN).find("tr").each(function(){aK++;if(aI&&aK===(aL-1)){aM=am(this).find("td").html()}else{if(aI&&aK===aL){aJ=am(this).find("td").html()}else{aH.push(am(this).html())}}});aE="<TR>";if(aG.randomize){aH.sort(q)}for(O=0;O<aH.length;O++){aE+=aH[O];if((O+1)%aG.perRow===0){aE+="</TR><TR>"}}aE+="</TR>";if(aI){aE+="<TR><TD colspan='99'>"+aM+aJ+"</TD></TR>"}am(aN).find("tr").remove();am(aN).find("table").append(aE)})};am.fn.SPServices.SPAutocomplete=function(aF){var aG=am.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:false,highlightClass:"",uniqueVals:false,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:false},aF);var aI;var aE=am("input[Title='"+aG.columnName+"']");aE.css("position","");var aH=aE.css("color");var aJ=aE.css("width");if(aE.html()===null&&aG.debug){X("SPServices.SPAutocomplete","columnName: "+aG.columnName,"Column is not an input control or is not found on page");return}aE.closest("span").find("br").remove();aE.wrap("<div>");var i=af("SPAutocomplete",aG.columnName);aE.after("<div><ul id='"+i+"' style='width:"+aJ+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");am("#"+i).css("width",aJ);am(aE).keyup(function(){var aS=am(this).val();am("#"+i).hide();if(aS.length<aG.numChars){return false}aE.css({"background-image":"url("+aG.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var aR=[];var aK="<Query><OrderBy><FieldRef Name='"+aG.sourceColumn+"'/></OrderBy><Where>";if(aG.CAMLQuery.length>0){aK+="<And>"}aK+="<"+aG.filterType+"><FieldRef Name='"+aG.sourceColumn+"'/><Value Type='Text'>"+aS+"</Value></"+aG.filterType+">";if(aG.CAMLQuery.length>0){aK+=aG.CAMLQuery+"</And>"}aK+="</Where></Query>";am().SPServices({operation:"GetListItems",async:false,webURL:aG.WebURL,listName:aG.sourceList,CAMLQuery:aK,CAMLQueryOptions:aG.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+aG.sourceColumn+"' /></ViewFields>",CAMLRowLimit:aG.CAMLRowLimit,completefunc:function(aV){var aU=aG.ignoreCase?aS.toUpperCase():aS;am(aV.responseXML).SPFilterNode("z:row").each(function(){var aX=am(this).attr("ows_"+aG.sourceColumn);var aY=aG.ignoreCase?am(this).attr("ows_"+aG.sourceColumn).toUpperCase():am(this).attr("ows_"+aG.sourceColumn);if(aG.filterType==="Contains"){var aW=aY.indexOf(aU);if((aW>=0)&&(!aG.uniqueVals||(am.inArray(aX,aR)===-1))){aR.push(am(this).attr("ows_"+aG.sourceColumn))}}else{if(aU===aY.substr(0,aU.length)&&(!aG.uniqueVals||(am.inArray(aX,aR)===-1))){aR.push(am(this).attr("ows_"+aG.sourceColumn))}}})}});var aN="";for(O=0;O<aR.length;O++){if(aG.highlightClass.length>0){var aM=new RegExp(aS,aG.ignoreCase?"gi":"g");var aP=aR[O].match(aM);var aO=0;for(aI=0;aI<aP.length;aI++){var aQ=aR[O].indexOf(aP[aI],aO);var aL=aQ+aP[aI].length;var aT="<span class='"+aG.highlightClass+"'>"+aP[aI]+"</span>";aR[O]=aR[O].substr(0,aQ)+aT+aR[O].substr(aL);aO=aQ+aT.length}}aN+="<li style='display: block;position: relative;cursor: pointer;'>"+aR[O]+"</li>"}am("#"+i).html(aN);am("#"+i+" li").click(function(){am("#"+i).fadeOut(aG.slideUpSpeed);aE.val(am(this).text())}).mouseover(function(){var aU={"cursor":"hand","color":"#ffffff","background":"#3399ff"};am(this).css(aU)}).mouseout(function(){var aU={"cursor":"inherit","color":aH,"background":"transparent"};am(this).css(aU)});if(aR.length>0){am("#"+i).slideDown(aG.slideDownSpeed)}aE.css("background-image","")})};am.fn.SPServices.SPGetQueryString=function(aF){var aH=am.extend({},{lowercase:false},aF);var aK={};var aE=location.search.slice(1).split("&");for(var aG=0;aG<aE.length;aG++){var aJ=aE[aG].split("=");var aI=aH.lowercase?aJ[0].toLowerCase():aJ[0];aK[aI]=decodeURIComponent(aJ[1]||"")}return aK};am.fn.SPServices.SPListNameFromUrl=function(i){var aE=am.extend({},{listName:""},i);if(aE.listName.length>0){ae.thisList=aE.listName;return ae.thisList}else{if(ae.thisList.length>0){return ae.thisList}}var aG=location.href;var aF=aG.substring(0,aG.indexOf(".aspx"));var aH=decodeURIComponent(aF.substring(0,aF.lastIndexOf(Q)+1)).toUpperCase();am().SPServices({operation:"GetListCollection",async:false,completefunc:function(aI){am(aI.responseXML).find("List").each(function(){var aJ=am(this).attr("DefaultViewUrl");var aK=aJ.substring(0,aJ.lastIndexOf(Q)+1).toUpperCase();if(aH.indexOf(aK)>0){ae.thisList=am(this).attr("ID");return false}})}});return ae.thisList};am.fn.SPServices.SPUpdateMultipleListItems=function(aG){var aI=am.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:false},aG);var aH;var aK=[];var aJ=[];am().SPServices({operation:"GetListItems",async:false,webURL:aI.webURL,listName:aI.listName,CAMLQuery:aI.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(i){am(i.responseXML).SPFilterNode("z:row").each(function(){aK.push(am(this).attr("ows_ID"));var aL=am(this).attr("ows_FileRef");aL="/"+aL.substring(aL.indexOf(";#")+2);aJ.push(aL)})}});var aE;var aF="<Batch OnError='Continue'>";for(aH=0;aH<aK.length;aH++){aF+="<Method ID='"+aH+"' Cmd='"+aI.batchCmd+"'>";for(aE=0;aE<aI.valuepairs.length;aE++){aF+="<Field Name='"+aI.valuepairs[aE][0]+"'>"+L(aI.valuepairs[aE][1])+"</Field>"}aF+="<Field Name='ID'>"+aK[aH]+"</Field>";if(aJ[aH].length>0){aF+="<Field Name='FileRef'>"+aJ[aH]+"</Field>"}aF+="</Method>"}aF+="</Batch>";am().SPServices({operation:"UpdateListItems",async:false,webURL:aI.webURL,listName:aI.listName,updates:aF,completefunc:function(i){if(aI.completefunc!==null){aI.completefunc(i)}}})};am.fn.SPServices.SPGetListItemsJson=function(aG){var aH=am.extend({},{webURL:"",listName:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:false},aG);var aF;var aE={};var aJ=[];var i=am.Deferred();var aI=am().SPServices({operation:"GetListItemChangesSinceToken",webURL:aH.webURL,listName:aH.listName,CAMLViewName:aH.CAMLViewName,CAMLQuery:aH.CAMLQuery,CAMLViewFields:aH.CAMLViewFields,CAMLRowLimit:aH.CAMLRowLimit,CAMLQueryOptions:aH.CAMLQueryOptions,changeToken:aH.changeToken,contains:aH.contains});aI.done(function(){var aM="SPGetListItemsJson"+aH.webURL+aH.listName;var aN=am(aI.responseXML);aF=aN.find("Changes").attr("LastChangeToken");aN.find("listitems Changes Id[ChangeType='Delete']").each(function(){aJ.push(am(this).text())});if(aH.mapping===null){aN.find("List > Fields > Field").each(function(){var aP=am(this);var aQ=aP.attr("Type");if(am.inArray(aQ,ap)>=0){aE["ows_"+aP.attr("Name")]={mappedName:aP.attr("Name"),objectType:aP.attr("Type")}}})}else{aE=aH.mapping}if(aH.mappingOverrides!==null){for(var aK in aH.mappingOverrides){aE[aK]=aH.mappingOverrides[aK]}}if(am.isEmptyObject(aE)){aE=am(document).data(aM)}else{am(document).data(aM,aE)}var aL=aN.SPFilterNode("z:row").SPXmlToJson({mapping:aE,sparse:true});var aO={changeToken:aF,mapping:aE,data:aL,deletedIds:aJ};i.resolveWith(aO)});return i.promise()};am.fn.SPServices.SPConvertDateToISO=function(i){var aE=am.extend({},{dateToConvert:new Date(),dateOffset:"-05:00"},i);var aF="";var aG=aE.dateToConvert;aF+=aG.getFullYear()+"-";aF+=u(aG.getMonth()+1)+"-";aF+=u(aG.getDate());aF+="T"+u(aG.getHours())+":";aF+=u(aG.getMinutes())+":";aF+=u(aG.getSeconds())+"Z"+aE.dateOffset;return aF};am.fn.SPFilterNode=function(i){return this.find("*").filter(function(){return this.nodeName===i})};am.fn.SPXmlToJson=function(i){var aF=am.extend({},{mapping:{},includeAllAttrs:false,removeOws:true,sparse:false},i);var aG;var aE=[];this.each(function(){var aK={};var aM=this.attributes;if(!aF.sparse){am.each(aF.mapping,function(){aK[this.mappedName]=""})}for(aG=0;aG<aM.length;aG++){var aL=aM[aG].name;var aJ=aF.mapping[aL];var aH=typeof aJ!=="undefined"?aJ.mappedName:aF.removeOws?aL.split("ows_")[1]:aL;var aI=typeof aJ!=="undefined"?aJ.objectType:undefined;if(aF.includeAllAttrs||aJ!==undefined){aK[aH]=M(aM[aG].value,aI)}}aE.push(aK)});return aE};function M(aE,i){var aF;switch(i){case"Text":aF=s(aE);break;case"DateTime":case"datetime":aF=d(aE);break;case"User":aF=S(aE);break;case"UserMulti":aF=x(aE);break;case"Lookup":aF=ax(aE);break;case"LookupMulti":aF=p(aE);break;case"Boolean":aF=r(aE);break;case"Integer":aF=a(aE);break;case"Counter":aF=a(aE);break;case"MultiChoice":aF=w(aE);break;case"Number":case"Currency":case"float":aF=P(aE);break;case"Calculated":aF=ar(aE);break;case"Attachments":aF=ax(aE);break;case"JSON":aF=au(aE);break;default:aF=s(aE);break}return aF}function s(i){return i}function a(i){return parseInt(i,10)}function P(i){return parseFloat(i)}function r(aE){var i=aE==="0"?false:true;return i}function d(aG){var aH=aG.split("T")[0]!==aG?aG.split("T"):aG.split(" ");var aI=aH[0].split("-");var aF=aH[1].split(":");var aE=aF[2].split("Z");var i=new Date(aI[0],(aI[1]-1),aI[2],aF[0],aF[1],aE[0]);return i}function S(aF){if(aF.length===0){return null}else{var i=new n(aF);var aE=i.value.split(",#");if(aE.length===1){return{userId:i.id,userName:i.value}}else{return{userId:i.id,userName:aE[0].replace(/(,,)/g,","),loginName:aE[1].replace(/(,,)/g,","),email:aE[2].replace(/(,,)/g,","),sipAddress:aE[3].replace(/(,,)/g,","),title:aE[4].replace(/(,,)/g,",")}}}}function x(aF){if(aF.length===0){return null}else{var aG=[];var aE=aF.split(";#");for(O=0;O<aE.length;O=O+2){var i=S(aE[O]+";#"+aE[O+1]);aG.push(i)}return aG}}function ax(i){if(i.length===0){return null}else{var aE=new n(i);return{lookupId:aE.id,lookupValue:aE.value}}}function p(aE){if(aE.length===0){return null}else{var aG=[];var i=aE.split(";#");for(O=0;O<i.length;O=O+2){var aF=ax(i[O]+";#"+i[O+1]);aG.push(aF)}return aG}}function w(aF){if(aF.length===0){return null}else{var i=[];var aE=aF.split(";#");for(O=0;O<aE.length;O++){if(aE[O].length!==0){i.push(aE[O])}}return i}}function ar(aE){if(aE.length===0){return null}else{var i=aE.split(";#");return M(i[1],i[0])}}function au(i){if(i.length===0){return null}else{return am.parseJSON(i)}}am.fn.SPServices.SPFindPeoplePicker=function(aF){var aG=am.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:true},aF);var aJ=am("nobr").filter(function(){return am(this).contents().eq(0).text()===aG.peoplePickerDisplayName}).closest("tr");var aE=aJ.find("div[name='upLevelDiv']");var i=aJ.find("img[Title='Check Names']:first");if(aG.valueToSet.length>0){aE.html(aG.valueToSet)}if(aG.checkNames){i.click()}var aI=am.trim(aE.text());var aH=[];aE.children("span").each(function(){var aM=am(this).find("div[data]").attr("data");var aK={};if(typeof aM!=="undefined"){var aN=am.parseXML(aM);var aL=am(aN);aL.find("DictionaryEntry").each(function(){var aO=am(this).find("Key").text();var aP=am(this).find("Value").text();aK[aO]=aP});aH.push(aK)}else{am().SPServices({operation:"GetUserInfo",async:false,cacheXML:true,userLoginName:am(this).attr("title"),completefunc:function(aO){am(aO.responseXML).find("User").each(function(){am.each(this.attributes,function(aQ,aS){var aP=aS.name;var aR=aS.value;aK[aP]=aR});aH.push(aK)})}})}});return{row:aJ,contents:aE,currentValue:aI,checkNames:i,dictionaryEntries:aH}};am.fn.SPServices.Version=function(){return ab};am.fn.SPServices.SPDropdownCtl=function(aG){var aH=am.extend({},{displayName:""},aG);var aF={};var aJ=am().SPServices.SPGetStaticFromDisplay({listName:am().SPServices.SPListNameFromUrl(),columnDisplayName:aH.displayName});if((aF.Obj=am("select[Title='"+aH.displayName+"']")).length===1){aF.Type=Y.simple}else{if((aF.Obj=am("input[Title='"+aH.displayName+"']")).length===1){aF.Type=Y.complex}else{if((aF.Obj=am("select:regex(id, ("+aJ+")(_)[0-9a-fA-F]{8}(-))")).length===1){aF.Type=Y.simple}else{if((aF.Obj=am("select[ID$='SelectCandidate'][Title^='"+aH.displayName+" ']")).length===1){aF.Type=Y.multiSelect}else{if((aF.Obj=am("select[ID$='SelectCandidate'][Title$=': "+aH.displayName+"']")).length===1){aF.Type=Y.multiSelect}else{if((aF.Obj=am("select[ID$='SelectCandidate'][Title$='\""+aH.displayName+"\".']")).length===1){aF.Type=Y.multiSelect}else{if((aF.Obj=am("select[ID$='SelectCandidate'][Title$=' "+aH.displayName+"']")).length===1){aF.Type=Y.multiSelect}else{aF.Type=null}}}}}}}if(aF.Type===null){var aI=z(aH.displayName);if(aI!==undefined){var aE=aI.find("select[title^='"+aH.displayName+"'][id$='$Lookup']");if(aE&&aE.length===1){aF.Type=Y.simple;aF.Obj=aE}}}if(aF.Type===Y.complex){aF.optHid=am("input[id='"+aF.Obj.attr("optHid")+"']")}else{if(aF.Type===Y.multiSelect){aF.container=aF.Obj.closest("span");aF.MultiLookupPickerdata=aF.container.find("input[id$='"+aq+"_data'], input[id$='"+g+"_data']");var i=aF.container.find("[id$='AddButton']").attr("id");aF.master=window[i.replace(/AddButton/,aq+"_m")]||window[i.replace(/AddButton/,g+"_m")]}}return aF};function at(){if(typeof _spPageContextInfo!=="undefined"){this.thisSite=_spPageContextInfo.webServerRelativeUrl;this.thisList=_spPageContextInfo.pageListId;this.thisUserId=_spPageContextInfo.userId}else{this.thisSite=(typeof L_Menu_BaseUrl!=="undefined")?L_Menu_BaseUrl:"";this.thisList="";this.thisUserId=(typeof _spUserId!=="undefined")?_spUserId:undefined}}function W(aP,aL,aQ,aG){if(typeof aQ==="undefined"){return""}var aM;var aN="";var aK;var aI;var aO=[];var aH=aG.relatedWebURL.length>0?aG.relatedWebURL:am().SPServices.SPGetCurrentSite();switch(aL.attr("Type")){case"Text":aN=aQ;break;case"URL":switch(aL.attr("Format")){case"Hyperlink":aN="<a href='"+aQ.substring(0,aQ.search(","))+"'>"+aQ.substring(aQ.search(",")+1)+"</a>";break;case"Image":aN="<img alt='"+aQ.substring(aQ.search(",")+1)+"' src='"+aQ.substring(0,aQ.search(","))+"'/>";break;default:aN=aQ;break}break;case"User":case"UserMulti":var aE=aQ.split(";#");for(aM=0;aM<aE.length;aM=aM+2){aO.push("<a href='/_layouts/userdisp.aspx?ID="+aE[aM]+"&Source="+A(location.href)+"'>"+aE[aM+1]+"</a>")}aN=aO.join(", ");break;case"Calculated":var aJ=aQ.split(";#");aN=aJ[1];break;case"Number":aI=aL.attr("Decimals");aN=typeof aI==="undefined"?parseFloat(aQ).toString():parseFloat(aQ).toFixed(aI).toString();break;case"Currency":aI=aL.attr("Decimals");aN=typeof aI==="undefined"?parseFloat(aQ).toFixed(2).toString():parseFloat(aQ).toFixed(aI).toString();break;case"Lookup":switch(aL.attr("Name")){case"FileRef":aK=aP.attr("BaseType")==="1"?aP.attr("RootFolder")+Q+"Forms/DispForm.aspx":aP.attr("RootFolder")+Q+"DispForm.aspx";aN="<a href='"+aK+"?ID="+aQ.substring(0,aQ.search(";#"))+"&RootFolder=*&Source="+A(location.href)+"'>"+aQ.substring(aQ.search(";#")+2)+"</a>";break;case"FileDirRef":aK=Q+aQ.substring(aQ.search(";#")+2);aN="<a href='"+aK+"'>"+aQ.substring(aQ.search(";#")+2)+"</a>";break;default:aK=D(aL.attr("List"),"DisplayForm");aN="<a href='"+aG.relatedWebURL+Q+aK+"?ID="+aQ.substring(0,aQ.search(";#"))+"&RootFolder=*&Source="+A(location.href)+"'>"+aQ.substring(aQ.search(";#")+2)+"</a>";break}break;case"LookupMulti":aK=D(aL.attr("List"),"DisplayForm");aN="";if(aQ.length>0){var aF=aQ.split(";#");for(aM=0;aM<aF.length/2;aM++){aO.push("<a href='"+aH+Q+aK+"?ID="+aF[aM*2]+"&RootFolder=*&Source="+A(location.href)+"'>"+aF[(aM*2)+1]+"</a>")}}aN=aO.join(", ");break;case"File":R=aQ.substring(aQ.search(";#")+2);aN="<a href='"+aP.attr("RootFolder")+Q+R+"'>"+R+"</a>";break;case"Counter":aN=aQ;break;case"DateTime":aN=aQ;break;default:aN=aQ;break}return aN}function t(aG){var aF;var aE="<table class='ms-vb' width='100%'>";for(aF=0;aF<aG.attributes.length;aF++){aE+="<tr><td width='10px' style='font-weight:bold;'>"+aF+"</td><td width='100px'>"+aG.attributes.item(aF).nodeName+"</td><td>"+N(aG.attributes.item(aF).nodeValue)+"</td></tr>"}aE+="</table>";return aE}function c(aF,aE){var i=[];switch(aF.Type){case Y.simple:if(aE){i.push(aF.Obj.find("option:selected").val()||[])}else{i.push(aF.Obj.find("option:selected").text()||[])}break;case Y.complex:if(aE){i.push(aF.optHid.val()||[])}else{i.push(aF.Obj.val()||[])}break;case Y.multiSelect:am(aF.master.resultControl).find("option").each(function(){if(aE){i.push(am(this).val())}else{i.push(am(this).html())}});break;default:break}return i}function X(aE,aG,aF){var i="<b>Error in function</b><br/>"+aE+"<br/>"+"<b>Parameter</b><br/>"+aG+"<br/>"+"<b>Message</b><br/>"+aF+"<br/><br/>"+"<span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";V(i)}function V(aI){var aF="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";am("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+aF+">"+aI);var i=am("#SPServices_msgBox").height();var aH=am("#SPServices_msgBox").width();var aG=(am(window).width()/2)-(aH/2)+"px";var aE=(am(window).height()/2)-(i/2)-100+"px";am("#SPServices_msgBox").css({border:"5px #C02000 solid",left:aG,top:aE}).show().fadeTo("slow",0.75).click(function(){am(this).fadeOut("3000",function(){am(this).remove()})})}function af(i,aE){return i+"_"+am().SPServices.SPGetStaticFromDisplay({listName:am().SPServices.SPListNameFromUrl(),columnDisplayName:aE})}function D(i,aF){var aE;am().SPServices({operation:"GetFormCollection",async:false,listName:i,completefunc:function(aG){aE=am(aG.responseXML).find("Form[Type='"+aF+"']").attr("Url")}});return aE}function av(aG,aE){var aF;for(aF=0;aF<aE.length;aF++){if(typeof aE[aF]==="string"){T.payload+=ay(aE[aF],aG[aE[aF]])}else{if(am.isArray(aE[aF])&&aE[aF].length===2){T.payload+=ay(aE[aF][0],aG[aE[aF][1]])}else{if((typeof aE[aF]==="object")&&(aE[aF].sendNull!==undefined)){T.payload+=((aG[aE[aF].name]===undefined)||(aG[aE[aF].name].length===0))?"":ay(aE[aF].name,aG[aE[aF].name])}else{X(aG.operation,"paramArray["+aF+"]: "+aE[aF],"Invalid paramArray element passed to addToPayload()")}}}}}function z(i){var aF;var aE=RegExp('FieldName="'+i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");am("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(aE.test(am(this).html())){aF=am(this);return false}});return aF}function k(i,aF){var aE=aF.substring(8);i.opheader=i.opheader.replace(aF,aE);i.opfooter=i.opfooter.replace(aF,aE);return i}function ay(aF,aE){var i=typeof aE!=="undefined"?aE:"";return"<"+aF+">"+i+"</"+aF+">"}function q(){return(Math.round(Math.random())-0.5)}function N(i){return((i.indexOf("http")===0)||(i.indexOf(Q)===0))?"<a href='"+i+"'>"+i+"</a>":i}function R(i){return i.substring(i.lastIndexOf(Q)+1,i.length)}var Z={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};var H={"&amp;":"&","&quot;":'"',"&lt;":"<","&gt;":">"};function j(i){return i.replace(/([\&"<>])/g,function(aF,aE){return Z[aE]})}function I(i){return i.replace(/(&quot;|&lt;|&gt;|&amp;)/g,function(aF,aE){return H[aE]})}function L(i){if(typeof i==="string"){return i.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;")}else{return i}}function A(i){return i.replace(/&/g,"%26")}function n(i){var aE=i.split(";#");this.id=aE[0];this.value=aE[1]}function u(i){return i<10?"0"+i:i}am.expr[":"].regex=function(aJ,aG,aF){var aK=aF[3].split(","),aE=/^(data|css):/,i={method:aK[0].match(aE)?aK[0].split(":")[0]:"attr",property:aK.shift().replace(aE,"")},aI="ig",aH=new RegExp(aK.join("").replace(/^\s+|\s+$/g,""),aI);return aH.test(jQuery(aJ)[i.method](i.property))}})(jQuery);
